<aside class="channels-sidebar" [class.channels-sidebar--hidden]="sidebarService.isHidden()">
  <div class="channels-sidebar__header">
    <div class="channels-sidebar__branding">
      <img
        src="/img/logos/workspace-logo.png"
        alt="Workspace Logo"
        class="channels-sidebar__logo"
      />
      <span class="channels-sidebar__workspace-name">Devspace</span>
    </div>
    <button
      class="channels-sidebar__multi-edit-btn"
      [class.channels-sidebar__multi-edit-btn--active]="isNewMessageActive()"
      (click)="openNewMessage()"
      [attr.aria-label]="'Open new message'"
    >
      <img
        src="/img/icon/channel-bar/multi-edit-default.svg"
        alt=""
        class="channels-sidebar__multi-edit-icon"
      />
    </button>
  </div>

  <div class="channels-sidebar__content">
    <!-- Channels Dropdown -->
    <div class="channels-sidebar__section">
      <div class="channels-sidebar__section-header">
        <button
          class="channels-sidebar__section-toggle"
          (click)="toggleChannels()"
          [attr.aria-label]="isChannelsOpen() ? 'Collapse channels' : 'Expand channels'"
        >
          <span class="channels-sidebar__dropdown-icon-wrapper">
            <img
              src="/img/icon/channel-bar/arrow-drop-down-default.svg"
              alt=""
              class="channels-sidebar__dropdown-icon"
              [class.channels-sidebar__dropdown-icon--open]="isChannelsOpen()"
            />
          </span>

          <span class="channels-sidebar__workspace-icon-wrapper">
            <img
              src="/img/icon/channel-bar/workspaces-default.svg"
              alt=""
              class="channels-sidebar__workspace-icon"
            />
          </span>
          <span class="channels-sidebar__section-title">Channels</span>
        </button>

        <button
          class="channels-sidebar__section-add"
          [class.channels-sidebar__section-add--active]="isAddChannelActive()"
          (click)="$event.stopPropagation(); addChannel()"
          [attr.aria-label]="'Add channel'"
        >
          <img
            src="/img/icon/channel-bar/add-channel-default.svg"
            alt=""
            class="channels-sidebar__add-icon"
          />
        </button>
      </div>

      @if (isChannelsOpen()) {
      <div class="channels-sidebar__section-content">
        @if (dummyChannels().length > 0) { @for (channel of dummyChannels(); track channel.id) {
        <button
          class="channels-sidebar__item"
          [class.channels-sidebar__item--active]="selectedChannelId() === channel.id"
          (click)="selectDummyChannel(channel.id)"
        >
          <span class="channels-sidebar__item-content">
            <span class="channels-sidebar__item-icon-wrapper">
              <img
                src="/img/icon/channel-bar/tag-default.svg"
                alt=""
                class="channels-sidebar__item-icon"
              />
            </span>
            <span class="channels-sidebar__item-name">{{ channel.name }}</span>
          </span>
        </button>
        } }

        <button class="channels-sidebar__add-channel-btn" (click)="addChannel()">
          <span class="channels-sidebar__add-channel-content">
            <span class="channels-sidebar__add-channel-icon-wrapper">
              <img
                src="/img/icon/channel-bar/add-channel-circle-default.svg"
                alt=""
                class="channels-sidebar__add-channel-icon"
              />
            </span>
            <span class="channels-sidebar__add-channel-text">Channel hinzufügen</span>
          </span>
        </button>
      </div>
      }
    </div>

    <!-- Direct Messages Dropdown -->
    <div class="channels-sidebar__section">
      <div class="channels-sidebar__section-header">
        <button
          class="channels-sidebar__section-toggle"
          (click)="toggleDirectMessages()"
          [attr.aria-label]="
            isDirectMessagesOpen() ? 'Collapse direct messages' : 'Expand direct messages'
          "
        >
          <span class="channels-sidebar__dropdown-icon-wrapper">
            <img
              src="/img/icon/channel-bar/arrow-drop-down-default.svg"
              alt=""
              class="channels-sidebar__dropdown-icon"
              [class.channels-sidebar__dropdown-icon--open]="isDirectMessagesOpen()"
            />
          </span>

          <span class="channels-sidebar__workspace-icon-wrapper">
            <img
              src="/img/icon/channel-bar/account-circle-default.svg"
              alt=""
              class="channels-sidebar__workspace-icon"
            />
          </span>
          <span class="channels-sidebar__section-title">Direct messages</span>
        </button>
      </div>

      @if (isDirectMessagesOpen()) {
      <div class="channels-sidebar__section-content">
        @if (directMessages().length > 0) { @for (dm of directMessages(); track dm.id) {
        <button
          class="channels-sidebar__item channels-sidebar__item--dm"
          [class.channels-sidebar__item--active]="selectedDirectMessageId() === dm.id"
          (click)="selectDirectMessage(dm.id)"
        >
          <span class="channels-sidebar__item-content">
            <img [src]="dm.avatar" [alt]="dm.name" class="channels-sidebar__item-avatar" />
            <span class="channels-sidebar__item-name">{{ dm.name }}</span>
          </span>
        </button>
        } } @else {
        <div class="channels-sidebar__empty">
          <p>Keine Direktnachrichten verfügbar</p>
        </div>
        }
      </div>
      }
    </div>
  </div>
</aside>
